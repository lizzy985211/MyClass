import{h as g,i as D,w as B,c as y,a as u,j as L,v as R,F as S,e as V,u as A,l as C,o as w,t as F}from"./index-DXsCtUvq.js";import{i as M}from"./index-Bb6yjXMn.js";const P={class:"card"},E={class:"row",style:{"justify-content":"space-between","margin-bottom":"8px"}},I={class:"row"},N=["value"],q={__name:"PersonalTrendView",setup(O){const t=A(),d=g(null),m=g([]),o=g(""),x=g(null);let _;async function k(){var h,l,r,i;const p=t.params.school;d.value=await C(p);const a=t.params.grade,e=t.params.klass,n=t.params.subject,v=(i=(r=(l=(h=d.value)==null?void 0:h.data)==null?void 0:l[a])==null?void 0:r[e])==null?void 0:i[n],f=(v==null?void 0:v.examList)||[];m.value=f.map(c=>({id:c.id,name:c.name})),m.value.length&&!o.value&&(o.value=m.value[0].id),b()}function b(){var l,r,i,c;if(_||(_=M(x.value)),!d.value)return;const p=t.params.grade,a=t.params.klass,e=t.params.subject,n=(c=(i=(r=(l=d.value)==null?void 0:l.data)==null?void 0:r[p])==null?void 0:i[a])==null?void 0:c[e],f=((n==null?void 0:n.examList)||[]).filter(s=>s.id===o.value).sort((s,j)=>new Date(s.date)-new Date(j.date)),h={title:{text:"个人成绩趋势"},xAxis:{type:"category",data:f.map(s=>s.date)},yAxis:{type:"value"},tooltip:{trigger:"axis"},series:[{name:"分数",type:"line",data:f.map(s=>s.score)}]};_.setOption(h)}return D(k),B(()=>t.fullPath,k),(p,a)=>(w(),y("div",P,[u("div",E,[u("div",I,[a[1]||(a[1]=u("label",null,"学生",-1)),L(u("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),onChange:b},[(w(!0),y(S,null,V(m.value,e=>(w(),y("option",{key:e.id,value:e.id},F(e.name),9,N))),128))],544),[[R,o.value]])])]),u("div",{ref_key:"chartRef",ref:x,style:{height:"360px"}},null,512)]))}};export{q as default};
